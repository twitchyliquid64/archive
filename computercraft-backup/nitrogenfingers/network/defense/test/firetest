-- On Startup --
side = "top"
serverid = -1

function getPrefs()
  local file = io.open("/pref")
  if not file then
    print("pref file not found! Make sure you have run the register program.")
    return false
  end
  local sidl = file:read()
  sidl = string.gsub(sidl, "routerid=", "")
  print(sidl)
  sidl = tonumber(sidl)
  if sidl==0 then
    print("Client prefs not initialized- check readme for detals.")
    return false
  end
  serverid = sidl
  sidl = file:read()
  sidl = string.gsub(sidl, "side=", "")
  side = sidl
  return true
end

if not getPrefs() then return end
rednet.open(side)
rednet.send(serverid, "$SERVERMAGIC$FORWARD:1000:$GUN:1:$FIRE")
